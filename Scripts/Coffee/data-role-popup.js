// Generated by IcedCoffeeScript 108.0.11
(function() {
  var $, changeTitle, openPopup;

  $ = jQuery;

  changeTitle = function(a, e, fn) {
    var elm, text, title;
    elm = e.sender.element;
    if (elm.children().length > 0) {
      title = $(elm).find("h1, h2, h3, h4, h5").first();
      text = title.text();
      if (!text) {
        text = a.text();
      }
      elm.data("kendoWindow").title(text).center();
      title.remove();
      if (fn) {
        return fn(e);
      }
    } else {
      return setTimeout((function() {
        return changeTitle(a, e, fn);
      }), 200);
    }
  };

  openPopup = function() {
    var a, href, onclose, onopen;
    a = $(this);
    href = a.attr("href");
    onclose = a.attr("data-popup-on-close");
    onopen = a.attr("data-popup-on-open");
    $("<div>").appendTo("body").kendoWindow({
      content: href,
      minWidth: "65%",
      modal: true,
      activate: function(e) {
        return changeTitle(a, e, window[onopen]);
      },
      deactivate: function(e) {
        var fn;
        this.destroy();
        fn = window[onclose];
        if (fn) {
          return fn(e);
        }
      }
    });
    return false;
  };

  $.fn.addOpenPopupEvents = function() {
    return this.find("a[data-popup]").click(openPopup);
  };

  $(function() {
    return $(document.body).addOpenPopupEvents();
  });

}).call(this);
