(function(){var n,t=[].slice;n=jQuery;n.fn.extend({updateImage:function(i){var r,f,e,o,u;return u={url:"UpdateImage",debug:!1},u=n.extend(u,i),r=function(){var n;return n=1<=arguments.length?t.call(arguments,0):[],u.debug?typeof console!="undefined"&&console!==null?console.log.apply(console,n):void 0:void 0},f=function(){return FormData?(r("envoie via XHR2"),o):(r("envoie via XHR1"),e)},o=function(){var t;return t=n(this),n("<input>").attr("type","file").click().change(function(){var i,n;return t.css("opacity","0.5"),i=new FormData,i.append("image",this.files[0]),n=new XMLHttpRequest,n.open("POST",u.url),n.onreadystatechange=function(){var i;if(n.readyState===4&&n.status===200)return i=t.attr("src"),i+=i.indexOf("?")>0?"&":"?",i+="time="+(new Date).getTime(),t.attr("src",i),setTimeout(function(){return t.css("opacity","1")},600)},n.send(i)})},e=function(){var i,t;return r("création du formulaire"),t=n("<form>").attr("action",u.url).attr("method","post").attr("enctype","multipart/form-data").css("display","none"),r("création de l'input type file"),i=n("<input>").attr("type","file").attr("name","image").appendTo(t),r("add change action to input"),i.change(function(){return t.submit()}),n("body").append(t),i.click()},this.each(function(){var t;return t=n(this),r("add click action to",t),t.css("cursor","pointer").click(f())})}})}).call(this);